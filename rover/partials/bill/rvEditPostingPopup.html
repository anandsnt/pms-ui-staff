<div role="dialog" id="modal" class="modal-show">
    <form method="post" action="" id="edit-charge-options" name="edit-charge" class="modal-content form edit-charge" ng-click="clearErrorMessage()">
        <button class="modal-close" type="button"  ng-click="callActionsPopupAction('close')"  id="modal-close"><span class="icons icon-close invert"></span></button>

        <fieldset id="edit-charge" name="edit-charge" class="edit-charge">
            <div ng-include="'/assets/partials/common/notification_message.html'"></div>
            <span class="h2 message" translate>EDIT_CHARGE</span>
            <span class="text">{{selectedTransaction.desc}}<strong>{{currencySymbol}}{{selectedTransaction.amount}}</strong></span>
            <ul id="change-edit-type" class="modal-options">
                <li ng-class="{'active':!chargeCodeActive}" ng-click="setchargeCodeActive(false)" translate>AMOUNT</li>
                <li ng-class="{'active':chargeCodeActive}" ng-click="setchargeCodeActive(true)" translate>CHARGE_CODE</li>
            </ul>

            <!-- Edit amount field -->
            <div id="edit-amount" class="entry full-width" ng-hide="chargeCodeActive">
                <label for="new-amount">{{'NEW_AMOUNT' | translate}}(<span>{{currencySymbol}}</span>)</label>
                <input name="new-amount" id="new-amount" placeholder="{{'ENTER_VALUE_PLACEHOLDER' | translate}}" ng-model="newAmount" type="text" />
            </div>

            <!-- Charge code field, hidden until selected -->
            <div id="change-code" class="entry full-width" ng-show="chargeCodeActive">

                <select class="ac-select stateList guest-bill-edit-buttons" ac-model="selectedChargeCode" ac-options="chargeCode.description for chargeCode in getAllchargeCodes()" 
                ac-settings="{ comboMode: true, loadOnOpen: true, minWidth: '300px',placeholderText:'Search or Select codes to add' }" ac-change="stateSelected(value)"></select>
            </div>

            <!-- Preview, hidden until amount edited or charge code changed -->
            <div id="edit-preview" class="entry full-width notice" ng-show="selectedChargeCode || newAmount.length>0">
                <strong class="h4" translate>CHARGE_WILL_APPEAR_AS</strong>
                <ul>
                    <li>
                        <strong class="flag" translate>ADJUSTMENT</strong>
                        <span ng-hide="selectedChargeCode">
                        {{selectedTransaction.desc}} </span>
                        <span ng-show="selectedChargeCode">{{selectedChargeCode.description}}</span>               
                        <span class="value" ng-show="newAmount.length>0"> <span ng-class ="{'hidden':newAmount - selectedTransaction.amount< 0}">+</span>{{newAmount - selectedTransaction.amount |number:2}}</span>
                    </li>
                </ul>
            </div>
            <div>
                <button type="button" class="button green modal-close guest-bill-edit-buttons" ng-click="editCharge(newAmount,selectedChargeCode)" translate>CHANGE_AMOUNT</button>
                <button type="button" class="button blank guest-bill-edit-buttons" ng-click="callActionsPopupAction('close')" translate>CANCEL</button> 
            </div>
        </fieldset>
    </form>
</div>
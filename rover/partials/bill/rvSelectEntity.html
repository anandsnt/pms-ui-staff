<div id="billing-content" class="content-wrapper no-action" ng-controller="rvSelectEntityCtrl">
   <fieldset class="content-left">
      <div class="search-form" role="search">
         <div class="entry">
            <a href="#" id="billing-info-clear-query" class="clear-query">
            	<span class="icons icon-clear-search" ng-click="clearResults()" ng-class="{'visible': textInQueryBox!=''}">Clear query</span>
            </a>
            <button type="submit" name="submit" class="icons icon-search">Search</button>
            <input name="billing-info-query" id="billing-info-query" class="query" placeholder="Find Guest, Company or Travel Agent" type="search" autocomplete="off" ng-model="textInQueryBox" ng-keyup="queryEntered()"/>
         </div>
      </div>
      <div id="available-entities">
         <!-- Attached entities, if exist -->
         <span class="h3 message" ng-hide="textInQueryBox!=''">Attached Entities</span>
         <div id="entities" class="entities-list scrollable" ng-hide="textInQueryBox!=''" >
            <ul class="wrapper">
                 <li class="entity" ng-repeat="entity in attachedEntities"ng-class="{'guest':entity.entity_role =='guest','accompany':entity.entity_role =='accompanying guest','company':entity.entity_role =='company','travel-agent':entity.entity_role =='travel_agent'}" ng-click="selectEntity()">
                  <!-- image -->
                  <figure class="guest-image" ng-class="{'accompany':entity.entity_role =='accompanying guest'}">
                     <img src="{{entity.entity_avatar}}" alt="" />
                     <img src="{{entity.accompanyImage}}" alt="" ng-show="entity.entity_role =='accompany'"/>
                  </figure>
                  <!-- heading -->
                  <h2>{{entity.entity_name}}</h2>
                  <!-- icon -->
                  <span class="guest-status small-icon {{entity.status}}"  ng-hide="entity.entity_role =='company' || entity.entity_role =='travel_agent'" >{{entity.status}}</span>
                  <div class="status" ng-class="{'travel-agent':entity.entity_role =='travel_agent','company':entity.entity_role =='company'}" ng-show="entity.entity_role =='company' || entity.entity_role =='travel_agent'">{{entity.status}}</div>
                 </li>
            </ul>
         </div>
         <!-- Search results, show instead of attached entities when searching -->
         
        <ul id="filter-entities" class="modal-options" ng-show="textInQueryBox!=''">
			<li ng-click="toggleClicked(true)" ng-class="{'active':isReservationActive}">
				Reservations
			</li>
			<li ng-click="toggleClicked(false)" ng-class="{'active':!isReservationActive}">
				Cards
			</li>
		</ul>
		<div id="entities" class="entities-list scrollable" ng-show="textInQueryBox!='' && !isReservationActive" ng-iscroll='cards_search_scroller' ng-iscroll-delay="100" style="position:absolute;  bottom: 0px; left:0px; width: 100%;overflow:hidden;">
			<ul class="wrapper">
				
				<li class="entity" ng-repeat="row in results.cards"  ng-class="{'company': row.account_type.toLowerCase()=='company', 'travel-agent': row.account_type.toLowerCase()=='travelagent'}" ng-show="row.is_row_visible==true" ng-hide="results.length.cards == 0" ng-click="showBillGroup()">
	                <!-- image -->
	              	<figure class="guest-image" ng-if="escapeNull(row.company_logo)!=''">
	                        <img ng-src="{{row.company_logo}}" alt="">
	                </figure>
	
	                <figure class="guest-image" ng-if="escapeNull(row.company_logo)==''">
	                    <div class="guest-image icons icon-company" ng-if="escapeNull(row.account_type)=='COMPANY'" ></div>
	                    <div class="guest-image icons icon-travel-agent" ng-if="escapeNull(row.account_type)=='TRAVELAGENT'" ></div>
	                </figure>
	                <!-- heading -->
	                <h2 ng-bind-html="row.account_name | highlight:textInQueryBox:false"></h2>
	                <!-- icon -->
                  	<div class="status" ng-class="{'company': row.account_type.toLowerCase()=='company', 'travel-agent': row.account_type.toLowerCase()=='travelagent'}"></div>
                 </li>
                 
            	<!-- No results / no content when searched query not found-->
            	<li class="no-content" ng-show="results.cards.length==0 && textInQueryBox!='' && !isReservationActive">
					<div class="info">
						<span class="icon-no-content icon-cards"></span>
						<strong class="h1">No matches have been found</strong>
					</div>
				</li>
			</ul>
		</div>
		
		<div id="entities" class="entities-list scrollable" ng-show="textInQueryBox!='' && isReservationActive" ng-iscroll='res_search_scroller' ng-iscroll-delay="100" style="position:absolute;  bottom: 0px; left:0px; width: 100%;overflow:hidden;">
			<ul class="wrapper">
				<li class="entity" ng-repeat="row in results.reservations" ng-show="row.is_row_visible==true" ng-hide="results.length.reservations == 0" ng-class="{'guest':row.images.length <= 1,'accompany':row.images.length >1}">
							
							 <!-- image -->
							<figure class="guest-image" ng-show="row.images.length!=0 " ng-class="{'accompany': row.images.length >1}">	
								<img ng-repeat="image in row.images" 
								ng-src="{{image.guest_image}}" 

								ng-class="{'first-image':(row.images.length >1 && image.is_primary==true),

								'second-image':(row.images.length >1 && image.is_primary==false)}">

								<span class="vip" ng-show="row.vip==true">VIP</span>
							</figure>

							<div class="data">
								<h2 ng-bind-html="'{{row.lastname}}, {{row.firstname}}'|highlight:textInQueryBox:false" 
								ng-class="{'grey' : row.images.length >1}"> </h2>
								<span class="confirmation" ># {{row.confirmation}}</span>
								<span class="confirmation" >ROOM {{row.room}}</span>
							</div>	
							
							<span class="guest-status small-icon {{getGuestStatusMapped(row.reservation_status, row.is_opted_late_checkout)}}" ></span>
						
					</li>
					<!-- No results / no content when searched query not found-->
	            	<li class="no-content" ng-show="results.reservations.length==0 && textInQueryBox!='' && isReservationActive">
						<div class="info">
							<span class="icon-no-content icon-cards"></span>
							<strong class="h1">No matches have been found</strong>
						</div>
					</li>
				
			</ul>
		</div>
      </div>
   </fieldset>
   <fieldset class="content-right">
      <div class="no-content" >
         <div class="info">
            <strong class="h1">Entity not selected</strong>
            <span class="h2">Select Entity to configure bill routing</span>
         </div>
      </div>
        
   </fieldset>
</div>
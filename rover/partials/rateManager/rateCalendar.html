<span ng-controller="RateCalendarCtrl">
	<div id="rate-manager-not-configured" ng-if = "!currentFilterData.filterConfigured">
		 <span>
		 	<span>Rate Manager not configured<span>Please select filter options to begin</span></span>
	 	</span>
	</div>
	<div class="calendar-wraper">
		<div ng-show = "currentFilterData.filterConfigured && calendarMode == 'RATE_VIEW'">
		    <div style="width: 240px;overflow:hidden;height:{{uiOptions.tableHeight}}px; position:relative;" class='scrollable pinnedLeft' ng-iscroll="rate-calendar-left">
		    	<div class="wrapper">
			        <table class='rate-calendar'>
			            <thead>
			                <tr>
			                    <th class="cell" style="height: 53px; padding: 0 20 0 0;">
			                        <button ng-click="openCloseAllRestrictions('remove')" 
			                                class="button rm-buttonOpenClose"
			                                style=" margin-left:50px;"
			                                ng-class="{'green': anyRoomHasClosedRestriction, 'grey': !anyRoomHasClosedRestriction}" 
			                                ng-disabled="!anyRoomHasClosedRestriction">
			                            Open All
			                        </button>
			                        
			                        <button ng-click="openCloseAllRestrictions('add')" 
			                                class="button  rm-buttonOpenClose" 
			                                ng-class="{'red': !calendarData.disableCloseAllBtn, 'grey': calendarData.disableCloseAllBtn}" 
			                                ng-disabled="calendarData.disableCloseAllBtn">
			                            Close All
			                        </button>
			                    </th>
			                <tr>
			            </thead>
			            <tbody>
			                <td class="cell" style="padding: 20px; padding-right: 5px; overflow:visible;">
			                    <div class="bolder buttonToggleContainer">
			                        <button class="button rm-buttonToggle" ng-class="activeToggleButton == 'Rates' ? 'orange' : 'grey'" style="margin-bottom:4px; margin-top:-5px;" ng-click="toggleAllRates()">All Rates</button><br>
			                    <button class="button rm-buttonToggle " ng-class="activeToggleButton == 'Rooms' ? 'orange' : 'grey'"  style="margin-bottom: -5px;" ng-click="toggleAllRooms()">All Rooms</button>
			                    </div>

			                </td>
			                <tr class="cell" ng-repeat="rate in calendarData.data track by rate.id" ng-class="{'last': $last && loading === false}" ng-show="calendarMode === 'RATE_VIEW'">
			                    <td class="first-row force-align">
			                        <div ng-click="goToRoomTypeCalendarView(rate)">
			                            <span ng-class="{'gray': rateIsChild(rate) == true && ratesRoomsToggle !== 'ROOMS'}" title="{{rate.name}}">{{rate.name}}</span>
			                            <span> 
			                                <img src="/assets/arrow-down.png" ng-hide="hideRoomsDownArrow"/>
			                            </span>
			                        </div>
			                    </td>
			                </tr>
			            </tbody>
			        </table>
		        </div>
		    </div>
		    
		    
		    <div ng-iscroll="calendar-table-scroller" style="height:{{uiOptions.tableHeight}}px;" class="calendar-rate-table scrollable" id="rateViewCalendar">
		    	<div class="wrapper" style="width:{{uiOptions.tableWidth}}px;">
			        <table class="rate-calendar">
			            <thead>
			                <tr class="cell">
			                    <th ng-class="{{isWeekend(date)}} ? 'weekend_day' : ''" ng-repeat="date in calendarData.dates track by $index"
			                        style="width:{{uiOptions.columnWidth}}px;" > 
			                        <div ng-if="!isHistoryDate(date)" class="date-header" ng-class="{{isWeekend(date)}} ? 'weekend_day' : ''" >
			                            <span class="week-day">{{date| date:'EEEE'}}</span>
			                            <span>{{date| date:'MMMM dd'}}</span>
			                        </div>
			                    <div ng-if="isHistoryDate(date)" class="date-header isHistory-cell-content">
			                        <span class="week-day">{{date| date:'EEEE'}}</span>
			                        <span>{{date| date:'MMMM dd'}}</span>
			                    </div>
			                    </th>
			                </tr>
			            </thead>

			            <tbody>
			                <tr ng-if="calendarData.data.length > 1">

			                    <td ng-class="{{isWeekend(date)}} ? 'weekend_day' : ''" ng-repeat="date in calendarData.dates track by $index" class="cell" >
			                        <div class="cell-container" ng-class="{{isHistoryDate(date)}} ? 'history_cell_container' : ''"  ng-class="{{isWeekend(date)}} ? 'weekend_day' : ''" >

			                            <div ng-if="!isHistoryDate(date)" class="cell-content" ng-click="showUpdatePriceAndRestrictionsDialog(date, '', '', (ratesRoomsToggle === 'ROOMS' ? 'ROOM_TYPE' : 'RATE_TYPE'), true)">
			                                <div ng-include="'assets/partials/rateManager/restrictionsTemplate/restrictionsDivCalendarData.html'">
			                                </div>
			                            </div>
			                            <div ng-if="isHistoryDate(date)" class="cell-content isHistory-cell-content">
			                                <div ng-include="'assets/partials/rateManager/restrictionsTemplate/restrictionsDivCalendarData.html'">
			                                </div>
			                            </div>
			                        </div>
			                    </td>
			                </tr>
			                <tr ng-repeat="rate in calendarData.data track by rate.id" ng-class="{'last': $last && loading === false}" ng-show="calendarMode === 'RATE_VIEW'">

			                    <td ng-class="{{isWeekend(date)}} ? 'weekend_day' : ''" ng-repeat="date in calendarData.dates track by $index" class="cell" >
			                        <div class="cell-container" ng-class="{{isHistoryDate(date)}} ? 'history_cell_container' : ''"  ng-class="{{isWeekend(date)}} ? 'weekend_day' : ''" >
			                            <div ng-if="!isHistoryDate(date)" class="cell-content" ng-click="showUpdatePriceAndRestrictionsDialog(date, rate.id, rate.room_type_id, (ratesRoomsToggle === 'ROOMS' ? 'ROOM_TYPE' : 'RATE_TYPE'), false)">
			                                <div ng-include="'assets/partials/rateManager/restrictionsTemplate/restrictionsDivRateData.html'">
			                                </div>
			                            </div>
			                            <div ng-if="isHistoryDate(date)" class="cell-content isHistory-cell-content"  >
			                                <div ng-include="'assets/partials/rateManager/restrictionsTemplate/restrictionsDivRateData.html'">
			                                </div>
			                            </div>
			                        </div>
			                    </td>
			                </tr>
			            </tbody>
			        </table>
		        </div>
		    </div>
		</div>
		<div class='pinned-bottom'>
		    <ul class="restriction-legends" >
		        <li ng-repeat="restrictionType in calendarData.restriction_types">
		            <span class="restriction-icon {{restrictionType.background_class}} {{restrictionType.icon}}">{{restrictionType.days}}</span>	
		            <span >{{restrictionType.description}}</span>
		        </li>
		    </ul>
		</div>
	</div>
	<div ng-if = "currentFilterData.filterConfigured && calendarMode == 'ROOM_TYPE_VIEW'" ng-include="'/assets/partials/rateManager/roomTypeViewCalendar.html'" class="calendar-wraper"></div>
</span>




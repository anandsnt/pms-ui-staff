
<div ng-include="'/assets/partials/common/header.html'"></div>
<!-- Search form -->
<form method="get" action="" name="work-management-search-form" id="work-management-search-form" class="search-form has-options" role="search">
    <div class="entry search">
        <a href="#" id="work-management-clear-query" class="clear-query">
            <span class="icons icon-clear-search">Clear query</span>
        </a>
        <button type="submit" name="submit" class="icons icon-search">Search</button>
        <input name="work-management-query" id="work-management-query" ng-model="stateVariables.searchQuery" class="query" placeholder="Search by Room No. or Employee Name" type="search" autocomplete="off" rv-delay-textbox  delay="1000" function-to-fire="workManagementSearch"/>
    </div>
    <div class="entry options">
        <div class="select">
            <select ng-model="stateVariables.viewingDate.work_type_id" ng-options="workType.id as workType.name for workType in workTypes">
                <option value="" selected>Select a Work Type</option>
            </select>
        </div>
        <div class="entry has-datepicker">
            <input id="rmDateRange" placeholder="{{stateVariables.viewingDate.date | date : 'dd MMMM yyyy'}}" readonly="" maxlength="8" value="{{currentFilterData.selected_date_range}}" class="hasDatepicker"  name="">
            <button ng-click="showCalendar('RVWorkManagementSearchDatePickerController')" type="button" class="ui-datepicker-trigger" style="top: 0px">...</button>
        </div>
    </div>
</form> 

<!-- Search panel : SEARCH BY NAME -->
<section id="work-management-search" class="content scrollable showing-search" role="complementary" ng-show="stateVariables.searching && stateVariables.employeeSearch && !$scope.stateVariables.noSearchResults">
    <div class="wrapper" style="height:100%" ng-iscroll="roomSearchResults">
        <ul id="work-management-search-results" class="search-results">            
            <li class="employee" ng-repeat="maid in stateVariables.searchResults.maids">
                <a ng-click="showWorkSheet(maid.work_sheet_id)">
                    <div class="data">
                        <h2>{{maid.full_name}}</h2>
                    </div>
                    <div class="stayovers"><span>{{maid.stayovers.total_rooms_completed}}/{{maid.stayovers.total_rooms_assigned}}</span>stayovers</div>
                    <div class="departures"><span>{{maid.departures.total_rooms_completed}}/{{maid.departures.total_rooms_assigned}}</span>departures</div>
                    <!-- <div class="shift">{shift completed time}/{total shift time}</div> -->
                    <!-- Maid in room -->
                    <!-- <div class="location room">{room number}</div> -->
                    <!-- Maid on floor -->
                    <!-- <div class="location floor">{floor number}<sup>{st, nd, rd or th}</sup> floor</div> -->
                </a>
            </li>
        </ul>
    </div>
</section> 

<!-- Search panel : SEARCH BY ROOM NUMBER -->
<section id="work-management-search" class="content scrollable showing-search" role="complementary" ng-show="stateVariables.searching && !stateVariables.employeeSearch && !$scope.stateVariables.noSearchResults">
    <div class="wrapper" style="height:100%" ng-iscroll="maidsSearchResults">
        <ul id="work-management-search-results" class="search-results">
           <li class="room" ng-repeat="room in stateVariables.searchResults.rooms">
			<a ng-click="onRoomSelect(room)" ng-class="{'with-image': room.is_occupied}"> <!-- Add class="with-image" if room is occupied -->
				
                <div class="data">
					<h2 class="{{room.hk_status.value}}" ng-class="{'out' : room.hk_status.value == 'OO' || room.hk_status.value == 'OS'}">{{room.room_no}}</h2> <!-- If room is ooo or oos, class should be 'out'. Otherwise, use {room-status} -->
					<span class="room-status {{room.hk_status.value}}">{{room.hk_status.value}}</span>
				</div>

				<!-- {reservation-status} classes here are used from reservation screens, so sometimes they might be different than the actual status -->
				<div class="reservation-status">
					
                    <!-- {reservation-status} can be check-out(for due out or departed) or inhouse(for stayover) -->
					<div class="current {{departureClass[room.room_reservation_status]}}">
						<span class="guest-status {{departureClass[room.room_reservation_status]}}">{{room.room_reservation_status}}</span>
						<!-- Show only if applicable, {departure-time} can be time or 'out' if departed -->
						<span ng-if="room.room_reservation_status == 'Departed'">OUT</span>
                        <span ng-if="room.room_reservation_status != 'Departed'">{{ room.departure_time }}</span>
					</div>

					<!-- {reservation-status} can be check-in(for arrival or arrived) or no-show(if room is not allocated to guest) -->
					<div class="next {{arrivalClass[room.room_reservation_status]}}">
						<span class="guest-status {{arrivalClass[room.room_reservation_status]}}">{{room.room_reservation_status}}</span>
						<!-- Show only if applicable, {arrival-time} can only be time -->
						<span>{{room.arrival_time}}</span>
					</div>
				</div>

				<!-- Show if room is assigned or ooo/oos -->
				<div class="additional-info" ng-if="room.assignee_maid || room.hk_status.value == 'OO' || room.hk_status.value == 'OS'">
					<!-- Show only if room is assigned -->
					<span class="assigned">{{room.assignee_maid}}</span>
                    <span ng-if="!room.assignee_maid" class="unassigned">Unassigned</span>
					<!-- Show only if room is not in service -->
					<span class="service-status" ng-if="room.hk_status.value == 'OO' || room.hk_status.value == 'OS'">
                        <span ng-if="room.hk_status.value == 'OS'" class="service-status">Out of Service</span>
                        <span ng-if="room.hk_status.value == 'OO'" class="service-status">Out of Order</span>
                    </span>
				</div>

                <img ng-src="room.avatar_src" alt="" ng-show="room.is_occupied && room.is_vip"/>
                <span class="vip" ng-show="room.is_occupied && room.is_vip">VIP</span>
			</a>
		</li>
        </ul>
    </div>
</section> 

<!-- Search panel : EMPTY -->
<section id="work-management-search" class="content scrollable no-results" role="complementary" ng-show="stateVariables.noSearchResults">
    <div class="wrapper">
        <ul id="work-management-search-results" class="search-results">
            <li class="no-content">
                <div class="info">
                    <span class="icon-no-content icon-search"></span>
                    <strong class="h1">Find Room or Employee</strong>
                    <span class="h2">Search by <strong>Room Number</strong> or <strong>Employee Name</strong></span>
                </div>
            </li>
        </ul>
    </div>
</section>
	
<!-- Work Management -->
<section id="work-management" class="content scrollable" role="main" ng-if="!stateVariables.searching">
    <div class="wrapper">
        <div class="dashboard-block data">
            <ul>
                <li>Departures to clean<span class="red">{{workStats.departures.clean}}</span></li>
                <li>Total <i>Hours</i><span class="red">{{workStats.departures.total_hours}}</span></li>
                <li>Total Staff Required<span class="red">{{workStats.departures.total_maids_required}}</span></li>
                <li>Total Rooms Assigned<span class="red">{{workStats.departures.total_rooms_assigned}}</span></li>
                <li>Total Rooms Completed<span class="red">{{workStats.departures.total_rooms_completed}}</span></li>
            </ul>
        </div>
        <div class="dashboard-block data">
            <ul>
                <li>Stayovers to clean<span class="orange">{{workStats.stayovers.clean}}</span></li>
                <li>Total <i>Hours</i><span class="orange">{{workStats.stayovers.total_hours}}</span></li>
                <li>Total Staff Required<span class="orange">{{workStats.stayovers.total_maids_required}}</span></li>
                <li>Total Rooms Assigned<span class="orange">{{workStats.stayovers.total_rooms_assigned}}</span></li>
                <li>Total Rooms Completed<span class="orange">{{workStats.stayovers.total_rooms_completed}}</span></li>
            </ul>
        </div>
        <div class="dashboard-block buttons">
            <ul class="actions">
                <li><a ui-sref="rover.workManagement.multiSheet" class="button blue">Manage Work Sheets</a></li>
                <li><button ng-click="showCreateWorkSheetDialog()" class="button green open-modal">Create Work Sheet</button></li>
            </ul>
        </div>
    </div>
</section>

<!-- <section id="workManagement" class="content create-reservation scrollable" role="main">
	  <a ui-sref="rover.workManagement.multiSheet" type="button" class="button green"> Mangage Work Sheets</a>
	  <button ng-click="showCreateWorkSheetDialog()" type="button" class="button green">Create Work Sheet </button>
</section> -->
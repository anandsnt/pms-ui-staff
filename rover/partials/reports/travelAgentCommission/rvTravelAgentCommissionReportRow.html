<!-- Report content -->
    <div ng-controller="RVTravelAgentsCommissionReportCtrl" id="report-content" ng-iscroll="report-content-travel-agents-commission" class="report-content grid scrollable with-pagination"> <!-- Add class "with-pagination" if pagination is shown -->
        <div class="wrapper">
            <div ng-repeat="travel_agents in results">
            <h2>{{travel_agents.travel_agent_name}}, IATA: {{travel_agents.IATA_number}}</h2>
            <table class="commission-reports">
                <thead>
                    <tr>
                        <th class="room" rowspan="2">Room</th>
                        <th class="guest" rowspan="2">Guest</th>
                        <th class="code" rowspan="2">Rate Code</th>
                        <th class="amount" rowspan="2">Rate Amount</th>
                        <th class="comission" colspan="3">Commission</th>
                    </tr>
                    <tr class="bottom-row">

                        <th class="amount break">Revenue</th>
                        <th>%/{{currencySymbol}}</th>
                        <th class="amount">Net Amt</th>
                    </tr>

                </thead>
                <tfoot>
                    <!-- Travel Agent pagination // Shown when needed-->
                     <tr class="pagination">
                        <td colspan="7"> {{travel_agents.insidePaginationData}}
                        <!-- {../_shared/pagination.html} -->
                        <rv-pagination  page-options="travel_agents.insidePaginationData" page-data="travel_agents.total_reservations" >
 </rv-pagination>
                        </td>
                    </tr>
                    <tr class="totals">
                        <td colspan="3"></td>
                        <td>
                            Subtotals
                        </td>
                        <td>
                           {{currencySymbol}}{{travel_agents.sub_total.revenue}}
                        </td>
                        <td></td>
                        <td>
                            {{currencySymbol}}{{travel_agents.sub_total.net_amount}}
                        </td>
                    </tr>
                </tfoot>
                <tbody >

                    <!--
                        $rowspan - number of rates per this reservation
                    -->

                    <tr ng-repeat-start="reservation in travel_agents.reservations">
                        <td rowspan="{{reservation.rate_details.length}}">
                            <strong class="title">{{reservation.room_no}}</strong>
                        </td>
                        <td class="name" rowspan="{{reservation.rate_details.length}}">
                            <strong class="title">
                                <a href="#">{{reservation.last_name}}, {{reservation.first_name}}</a>
                            </strong>
                            <span class="data">{{reservation.confirm_no}}, Nights: {{reservation.nights}}</span>
                            <div class="guest-date">
                                <!-- check in -->
                                <div class="date">
                                    <span class="guest-status check-in">check-in</span>
                                    <time datetime="">
                                        <span>{{reservation.arrival_date}}</span>
                                        <span>{{reservation.arrival_time}}</span>
                                    </time>
                                </div>
                                <!-- check out -->
                                <div class="date">
                                    <span class="guest-status check-out">check-out</span>
                                    <time datetime="{datetime | exp.: 2017-02-01T12:00:00}">
                                        <span>{{reservation.dep_date}}</span>
                                        <span>{{reservation.departure_time}}</span>
                                    </time>
                                </div>
                            </div>
                        </td>
                        <!-- First Rate in row is displayed here,
                             if there are more than 1 rate, others will be display in rows below
                         -->
                        <td>
                            {{reservation.rate_details[0].rate_code}}
                        </td>
                        <td>
                            {{currencySymbol}} {{reservation.rate_details[0].rate_amount}}
                        </td>
                        <td rowspan="{{reservation.rate_details.length}}">
                            {{currencySymbol}}{{reservation.commission_revenue}}
                        </td>
                        <td rowspan="{{reservation.rate_details.length}}">
                            <!-- If admin settings are set to show comission amount:
                            {currency-symbol}{subtotal-commission-net-amount}
                            --
                                else if admin settings are set to show comission %:
                            -->
                            <span ng-if="reservation.commission_type == currencySymbol">{{currencySymbol}}{{reservation.commission_amount}}</span>
                            <span ng-if="reservation.commission_type == '%'">{{reservation.commission_amount}}%</span>

                        </td>
                        <td rowspan="{{reservation.rate_details.length}}">
                            {{currencySymbol}}{{reservation.net_amount}}
                        </td>
                    </tr>
                    <!-- If more than 1 rate per reservation:-->
                    <tr class="rate-row" ng-repeat="rate_details in reservation.rate_details"  ng-if="$index > 0" ng-repeat-end >
                        <td>{{rate_details.rate_code}}</td>
                        <td>{{rate_details.rate_amount}}</td>
                    </tr>

                   <!--  .. repeat per guest/reservation -->
                </tbody>
            </table>
            <!-- ... repeat per travel-agent L88-L191 -->
            </div>
        </div>
    </div>

    <rv-pagination  page-options="commisionReportTAPagination" page-data="totalCount" >
 </rv-pagination>

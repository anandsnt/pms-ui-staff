<div ng-controller = "rvReservationSearchWidgetController">
	<form method="get" action="" name="dashboard-search-form" id="dashboard-search-form" class="search-form" role="search" ng-class="{'enable-adding' :showAddNewGuestButton && showSearchResultsArea}">	
	    <div class="entry search">
	        <a href="#" id="dashboard-clear-query" class="clear-query" ng-class="{'visible': textInQueryBox!=''}" ng-click="clearResults()"> 
	            <span class="icons icon-clear-search">Clear query</span>
	        </a>
	        <button type="submit" name="submit" class="icons icon-search">Search</button>
	        <input name="dashboard-query" id="dashboard-query" class="query" placeholder="Name, Group, Room No. or Confirmation No." type="text" autocomplete="off" 
	        ng-change="queryEntered()" ng-focus="focusOnSearchText()"
	        ng-model="textInQueryBox"  ng-blur="focusOutOnSearchText()" >
	    </div>
		<a ng-click="addNewGuest($event)" class="add-new-button" ng-show="showAddNewGuestButton && showSearchResultsArea">+ Add new </a>	
	</form>

	<section id="dashboard-search" class="content scrollable" role="complementary" ng-show="showSearchResultsArea" ng-iscroll="result_showing_area" ng-iscroll-delay="1000">
	    <div class="wrapper"> 
	    	<div ng-include="'/assets/partials/common/notification_message.html'"></div>
	    	<div ng-show="results.length > 0">
	    		<button class="button blue" ng-click="loadPrevSet()" ng-disabled="isPrevButtonDisabled()" ng-class="{grey: isPrevButtonDisabled()}">prev</button>
	    		<button class="button blue" ng-click="loadNextSet()" ng-disabled="isNextButtonDisabled()" ng-class="{grey: isNextButtonDisabled()}">next</button>
	    		<span>showing {{start}} to {{end}} out of {{totalSearchResults}} results</span>
	    	</div>
	        <ul id="dashboard-search-results" class="search-results" > <!-- since parent id & class must have roles in displaying the bottom results, we are seperating these -->
				<li class="reservation" ng-repeat="row in results" ng-show="row.is_row_visible" ngrepeatend ngrepeatstarted>
					<!--, lastname: textInQueryBox, confirmation: textInQueryBox -->
					<a ng-class="getReservationClass(row.reservation_status)" ng-click="goToReservationDetails(row.id, row.confirmation)"> <!--ui-sref="rover.staycard.reservationcard.reservationdetails({id:row.id, confirmationId:row.confirmation, isrefresh: true})" -->
						<figure class="guest-image" ng-show="row.images.length!=0 " ng-class="{'accompany': row.images.length >1}">	
							<img ng-repeat="image in row.images" ng-src="{{image.guest_image}}" ng-class="{'first-image':(row.images.length >1 && image.is_primary==true)}">
							<!-- commented out for CICO-9877 -->
							<!-- <img ng-repeat="image in row.images" ng-src="{{image.guest_image}}" ng-class="{'first-image':(row.images.length >1 && image.is_primary==true), 'second-image':(row.images.length >1 && image.is_primary==false)}"> -->
							<span class="vip" ng-show="row.vip==true">VIP</span>
						</figure>
						<div class="data">
							<h2 ng-class="{'grey' : row.is_accompanying_guest=='1'}">
                                <span class="no-margin-right" ng-bind-html="escapeNull(row.lastname)|highlight:textInQueryBox:false"></span>,
								<span ng-bind-html="escapeNull(row.firstname)|highlight:textInQueryBox:false"></span>
							</h2>
							<span class="confirmation" ng-bind-html="'{{row.confirmation}}'|highlight:textInQueryBox:false">{{row.confirmation}}</span>
							<span class="icons icon-location" ng-hide="escapeNull(row.location)==''" >{{escapeNull(row.location)}}
							</span>
							<em class="icons icon-group" ng-hide="escapeNull(row.group)==''"  ng-bind-html="escapeNull(row.group)|highlight:textInQueryBox:false"></em>
						</div>	
						<div class="status" ng-class="getQueueClass(row.is_reservation_queued, row.is_queue_rooms_on, row.reservation_status)">				
							<span class="late-checkout-time" ng-hide="(row.reservation_status!='CHECKING_OUT'||row.reservation_status=='CHECKING_IN')&&row.is_opted_late_checkout==false">
								{{row.late_checkout_time}}
							</span>
							 <span class="pre-checkin-time" ng-show="row.arrival_time && row.is_pre_checkin && row.reservation_status=='CHECKING_IN'" ng-bind="row.arrival_time"></span>
							<span class="guest-status {{getGuestStatusMapped(row.reservation_status, row.is_opted_late_checkout,row.is_pre_checkin)}}">
							</span>
						</div>	
						<span class="room-number" ng-class="getMappedClassWithResStatusAndRoomStatus(row.reservation_status, row.roomstatus, row.fostatus, row.room_ready_status, row.checkin_inspected_only)" >
							<span ng-class="{'highlight': row.room.indexOf(textInQueryBox) != -1 && textInQueryBox!='' && textInQueryBox.length>=3 }" >
								{{row.room}}
							</span>			
						</span>
						<span class="room-status" ng-show="getRoomStatusMapped(row.roomstatus, row.fostatus) == 'not-ready' && row.reservation_status == 'CHECKING_IN'"  >{{row.fostatus}}</span>
					</a>
				</li>
				<li class="no-content" ng-show="showNoMatches(results, textInQueryBox.trim().length, isTyping, isSwiped)" >
					<div class="info">
						<span class="icon-no-content icon-search"></span>
						<strong class="h1">No matches </strong>
						<span class="h2">Check that you didn't mispell the <strong>Name</strong> or 
							<strong>Group</strong>, or typed in the wrong <strong>Room </strong> or 
							<strong>Confirmation</strong> number
						</span>
						<span ng-show="results.length==0 && showAddNewGuestButton"> or  <a>Add a New Guest <a/> </span>
						.
					</div>
				</li>
				<li class="no-content" ng-show="results.length == 0 && searchType != 'default' && (isLateCheckoutList && textInQueryBox=='')">
					<div class="info">
						<span class="icon-no-content icon-search"></span>
						<strong class="h1">No guests opted for late checkout </strong>
					</div>
				</li>
				<li class="no-content" ng-show="results.length == 0 && textInQueryBox.trim().length<3 && !swipeNoResults">
					<div class="info">
						<span class="icon-no-content icon-search"></span>
						<strong class="h1">Find Guests</strong>
						<span class="h2">
							Search by
							<strong>Name</strong>,
							<strong>Group</strong>,
							<strong>Room No.</strong>
							or
							<strong>Confirmation No.</strong>
						</span>
					</div>
				</li>
				<li class="no-content" ng-show="swipeNoResults">
					<div class="info">
						<span class="icon-no-content icon-search" ></span>
						<strong class="h1">No matches </strong>
						<span class="h2">Enter different search criteria to find reservation / guest. 
							
						</span>
						
					</div>
				</li>
	        </ul>
	    </div>
	</section>
</div>
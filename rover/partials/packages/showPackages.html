<div role="dialog" id="modal" class="modal-show" ng-class="{'modal-show': !modalClosing}" ng-click="clearErrorMessage()" ng-cloak>
    <div class="modal-content room-enhancements">
        <span class="h2 message">Room {{packageData.room_no}} Enhancements</span>
        <div ng-include="'/assets/partials/common/notification_message.html'"></div>
        <div class="scrollable" ng-iscroll="resultDetails" ng-iscroll-delay="500">
            <ul class="wrapper" >
                <li ng-repeat="existingPackages in packageData.existing_packages" class="addons-list">
                    <span class="item">{{existingPackages.name}}</span>

                    <!-- if addon type is adult /child type multiplification factor will be (addon_count*number of days*(adult_count or child_count)) -->
                    <!-- if addon type is person multiplification factor will be (addon_count*number of days*(adult_count+child_count))-->

                    <span >
                        <span class="count" >({{getAddonCount(existingPackages.amount_type.value, existingPackages.post_type.value, existingPackages.post_type.frequency,reservationData.reservation_card.number_of_adults, reservationData.reservation_card.number_of_children, packageData.duration_of_stay, existingPackages.charge_full_weeks_only, existingPackages.addon_count)}})</span>
                    </span>


                    <span class="base" ng-hide="existingPackages.is_rate_addon && existingPackages.is_inclusive">
                        at {{existingPackages.addon_currency}}{{existingPackages.amount | number : 2}} / {{existingPackages.amount_type.description}}
                        <span>
                            {{existingPackages.post_type.description}}
                        </span>

                    </span>

                    <!-- if addon type is adult /child type multiplification factor will be (addon_count*number of days*(adult_count or child_count)) -->
                    <!-- if addon type is person multiplification factor will be (addon_count*number of days*(adult_count+child_count))-->

                    <span ng-if="existingPackages.amount_type.value ==='ADULT'">
                        <span class="price" ng-hide="existingPackages.is_rate_addon && existingPackages.is_inclusive || existingPackages.post_type.value ==='STAY'">{{existingPackages.addon_currency}}{{existingPackages.totalAmount * reservationData.reservation_card.number_of_adults| number : 2}}</span>
                        <span class="price" ng-hide="existingPackages.is_rate_addon && existingPackages.is_inclusive || existingPackages.post_type.value !=='STAY'">{{existingPackages.addon_currency}}{{existingPackages.totalAmount * packageData.duration_of_stay * reservationData.reservation_card.number_of_adults| number : 2}}</span>
                    </span>
                     <span ng-if="existingPackages.amount_type.value ==='CHILD'">
                        <span class="price" ng-hide="existingPackages.is_rate_addon && existingPackages.is_inclusive || existingPackages.post_type.value ==='STAY'">{{existingPackages.addon_currency}}{{existingPackages.totalAmount*reservationData.reservation_card.number_of_children | number : 2}}</span>
                        <span class="price" ng-hide="existingPackages.is_rate_addon && existingPackages.is_inclusive || existingPackages.post_type.value !=='STAY'">{{existingPackages.addon_currency}}{{existingPackages.totalAmount * packageData.duration_of_stay*reservationData.reservation_card.number_of_children| number : 2}}</span>
                    </span>
                    <span ng-if="existingPackages.amount_type.value ==='FLAT'">
                        <span class="price" ng-hide="existingPackages.is_rate_addon && existingPackages.is_inclusive || existingPackages.post_type.value ==='STAY'">{{existingPackages.addon_currency}}{{existingPackages.totalAmount | number : 2}}</span>
                        <span class="price" ng-hide="existingPackages.is_rate_addon && existingPackages.is_inclusive || existingPackages.post_type.value !=='STAY'">{{existingPackages.addon_currency}}{{existingPackages.totalAmount * packageData.duration_of_stay| number : 2}}</span>
                    </span>
                    <span ng-if="existingPackages.amount_type.value ==='PERSON'">
                        <span class="price" ng-hide="existingPackages.is_rate_addon && existingPackages.is_inclusive || existingPackages.post_type.value ==='STAY'">{{existingPackages.addon_currency}}{{existingPackages.totalAmount*(reservationData.reservation_card.number_of_children+reservationData.reservation_card.number_of_adults) | number : 2}}</span>
                        <span class="price" ng-hide="existingPackages.is_rate_addon && existingPackages.is_inclusive || existingPackages.post_type.value !=='STAY'">{{existingPackages.addon_currency}}{{existingPackages.totalAmount * packageData.duration_of_stay*(reservationData.reservation_card.number_of_children+reservationData.reservation_card.number_of_adults)| number : 2}}</span>
                    </span>

                    <span class="price" ng-show="existingPackages.is_rate_addon && existingPackages.is_inclusive">INCL</span>
                    <button type="button" class="icons icon-trash" ng-hide="existingPackages.is_rate_addon" ng-click="removeSelectedAddons(existingPackages.id, $index)">Remove</button>
                </li>
            </ul>
        </div>
        <div class="actions">
            <!-- On Stay Card -->
            <button type="button" class="button orange" ng-click="goToAddons()">Add More to This Room</button>
            <button type="button" class="button blank" ng-click="closeAddOnPopup()">Close</button>

            <!-- On Addons screen
            <button type="button" class="button blank">Close</button>
            -->

            <!-- On Create Res. Enhance Stay screen:
            <button type="button" class="button white">Add More to This Room</button>
            <button type="button" class="button green">Go To Payment</button>-->
        </div>
    </div>




</div>
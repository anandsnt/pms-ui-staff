<div role="dialog" id="modal" class="modal-show" ng-class="{'modal-show': !modalClosing}" ng-cloak ng-click="clearErrorMessage()">

	<form ng-show="!shouldShowWaiting" name="deposit-balance" method="post" id="deposit-balance" class="modal-content form deposit-balance" action="{action}">
		<button type="button" id="modal-close" class="modal-close" ng-click="closeDepositModal()">
			<span class="icons icon-close invert"> </span>
		</button>
		<!-- Left side -->
		<fieldset class="content-left" ng-show="passData.origin=='STAYCARD'">
			<strong class="h2 message">Balance</strong>
			<ul id="expenses" class="expenses">
				<li>
					Room Cost
					<span ng-if="isBalanceAmountShown()"> {{currencySymbol}}{{depositBalanceData.data.room_cost}} </span>
                    <span ng-if="!isBalanceAmountShown()">{{'SUPPRESSED_RATES_TEXT' | translate}} </span>
				</li>
				<li>
					Packages
					<span ng-if="isBalanceAmountShown()"> {{currencySymbol}}{{depositBalanceData.data.packages}} </span>
                    <span ng-if="!isBalanceAmountShown()">{{'SUPPRESSED_RATES_TEXT' | translate}} </span>
				</li>
				<li class="total">
					Sub Total
					<span ng-if="isBalanceAmountShown()"> {{currencySymbol}}{{depositBalanceData.data.sub_total}} </span>
                    <span ng-if="!isBalanceAmountShown()">{{'SUPPRESSED_RATES_TEXT' | translate}} </span>
				</li>
				<li>
					Fees
					<span ng-if="isBalanceAmountShown()"> {{currencySymbol}}{{depositBalanceData.data.fees}} </span>
                    <span ng-if="!isBalanceAmountShown()">{{'SUPPRESSED_RATES_TEXT' | translate}} </span>
				</li>
				<li class="total">
					Stay Total
					<span ng-if="isBalanceAmountShown()"> {{currencySymbol}}{{depositBalanceData.data.stay_total}} </span>
                    <span ng-if="!isBalanceAmountShown()">{{'SUPPRESSED_RATES_TEXT' | translate}} </span>
				</li>
				<li>
					Nightly Charge
					<span ng-if="isBalanceAmountShown()"> {{currencySymbol}}{{depositBalanceData.data.nightly_charges}} </span>
                    <span ng-if="!isBalanceAmountShown()">{{'SUPPRESSED_RATES_TEXT' | translate}} </span>
				</li>
				<li class="total final">
					Total Cost of Stay
					<span ng-if="isBalanceAmountShown()"> {{currencySymbol}}{{depositBalanceData.data.total_cost_of_stay}} </span>
                    <span ng-if="!isBalanceAmountShown()">{{'SUPPRESSED_RATES_TEXT' | translate}} </span>
				</li>
				<li class="deposit">
					Deposit Paid
					<span class="green" ng-if="isBalanceAmountShown()"> {{currencySymbol}}{{depositBalanceData.data.deposit_paid}} </span>
                    <span ng-if="!isBalanceAmountShown()">{{'SUPPRESSED_RATES_TEXT' | translate}} </span>
				</li>
				<li class="balance">
					Outstanding Stay Total
					<span class="red" ng-if="isBalanceAmountShown()"> {{currencySymbol}}{{depositBalanceData.data.outstanding_stay_total}} </span>
                    <span ng-if="!isBalanceAmountShown()">{{'SUPPRESSED_RATES_TEXT' | translate}} </span>

				</li>
			</ul>
		</fieldset>

		<fieldset class="content-left" ng-show="passData.origin=='GROUP'">
            <strong class="h2 message">Balance</strong>
            <ul id="expenses" class="expenses">
                <li ng-show="depositBalanceData.account_type=='GROUP'">Projected Room Revenue
                	<span>{{currencySymbol}}{{depositBalanceData.projected_revenue_details.room_revenue | number:2}}</span>
                </li>
                <li ng-show="depositBalanceData.account_type=='GROUP'">Projected Add-On Revenue
                	<span>{{currencySymbol}}{{depositBalanceData.projected_revenue_details.package_revenue | number:2}}</span>
                </li>
                <li ng-show="depositBalanceData.account_type=='GROUP'">Projected Tax
                	<span>{{currencySymbol}}{{depositBalanceData.projected_revenue_details.exclusive_tax | number:2}}</span>
                </li>
                <li class="total" ng-show="depositBalanceData.account_type=='GROUP'">Total Projected Revenue
                	<span>{{currencySymbol}}{{depositBalanceData.projected_revenue_details.total_revenue | number:2}}</span>
                </li>
                <li>Actual Room Revenue
                	<span>{{currencySymbol}}{{depositBalanceData.actual_revenue_details.room_revenue | number:2}}</span>
                </li>
                <li>Actual Add-On Revenue
                	<span>{{currencySymbol}}{{depositBalanceData.actual_revenue_details.package_revenue | number:2 }}</span>
                </li>
                <li>Actual Tax
                	<span>{{currencySymbol}}{{depositBalanceData.actual_revenue_details.exclusive_tax | number:2}}</span>
                </li>
                <li class="deposit">Total Balance
                	<span class="red">{{currencySymbol}}{{depositBalanceData.current_balance | number:2}}</span>
                </li>
                <li class="balance">Payments Received
                	<span class="green">{{currencySymbol}}{{depositBalanceData.payments_received | number:2}}</span>
                </li>
            </ul>
        </fieldset>

		<!-- Right side -->
		<fieldset class="content-right">
			<strong class="h2 message">Deposit</strong>
			<div ng-include="'/assets/partials/common/notification_message.html'"></div>
			<div class="dates notice" ng-if="depositBalanceData.data.deposit_dues">
            	<strong>Deposit Due</strong>
                    <div class="scrollable" ng-iscroll="deopositdue" >
                            <ul class="wrapper ">
                            <li ng-repeat="depositDue in depositBalanceData.data.deposit_dues" ng-class="{'paid': depositDue.paid, 'due': !depositDue.paid}">
                            {{depositDue.due_date | date : dateFormat}}
                            <span ng-if="isBalanceAmountShown()">{{currencySymbol}}{{depositDue.due_amount}}</span>
                            <span ng-if="!isBalanceAmountShown()">{{'SUPPRESSED_RATES_TEXT' | translate}}</span>
                            </li>
                            </ul>
                    </div>
        	</div>

        	<div class="dates notice" ng-if="depositBalanceData.paid_deposits">
            	<strong>Deposit Paid</strong>
                    <div class="scrollable" ng-iscroll="deopositdue" >
                            <ul class="wrapper ">
                            <li ng-repeat="paidDeposit in depositBalanceData.paid_deposits" class="due">
                            {{paidDeposit.date | date : dateFormat}}
                            <span>{{currencySymbol}}{{paidDeposit.amount}}</span>
                            </li>
                            </ul>
                    </div>
        	</div>
			<div class="payment-form scrollable for-deposit" id="set-payment" ng-iscroll="payment-deposit-scroll">
                <div class="wrapper">
					<snt-payment
							hotel-config="hotelPaymentConfig"
							reservation-id="{{reservationId}}"
							bill-number="billNumber"
							payment-types="passData.details.paymentTypes"
							selected-payment-type="paymentType"
							selected-c-c="depositDetails.attached_card"
							amount='depositBalanceMakePaymentData.amount'
							action-type="DEPOSIT"
							deposit-policy-name="{{depositPolicyName}}"
							is-editable='isDepositEditable'
							is-rate-suppressed='isReservationRateSuppressed'
							has-permission='hasPermissionToMakePayment()'
							form-template-url='/assets/partials/staycard/rvStaycardDepositBalancePopup.html'
							first-name="{{firstName}}"
							last-name="{{lastName}}"
							ng-show="!errorOccured && !depositPaidSuccesFully">
					</snt-payment>
				<!-- Reference field - use only when it exsits -->
			     <div class="feedback no-top-border" ng-show="shouldShowMakePaymentScreen && depositPaidSuccesFully">
	                <div class="notice success">Deposit paid!</div>
	                <ul class="transaction">
	                    <li ng-hide="authorizedCode.length === 0">
	                        Your Authorize code is: <span class="auth" >{{authorizedCode}}</span>
	                    </li>
	                    <li ng-if="isShowFees()">
                        Amount paid: <span class="value">{{currencySymbol}}{{depositBalanceMakePaymentData.amount | number:2 }} + {{currencySymbol}}{{feeData.calculatedFee}} fee
                        </span>
	                    </li>
	                    <li ng-if="!isShowFees()">
	                        Amount paid: <span class="value">{{currencySymbol}}{{depositBalanceMakePaymentData.amount | number:2 }}
	                        </span>
	                    </li>
	                </ul>
	            </div>
				<div class="actions" ng-show="shouldShowMakePaymentScreen && !depositWithGiftCard">
					<button type="button" id="close" class="button blank modal-close" ng-click="closeDepositModal()">
						Close
					</button>
					<span ng-hide="depositPaidSuccesFully">
							<span>
								<button type="button" ng-disabled="disableMakePayment()" ng-class="showMakePaymentButtonStatus()" ng-click="clickedMakePayment()"  id="make-payment"  class="button modal-close"
								ng-hide="hideMakePayment()" >
								Make Payment
								</button>
							</span>

					 <!-- the below functionality will be implemented later CICO-13435 -->
						<!-- <span ng-show="shouldShowMakePaymentButton"><button type="button" ng-disabled="disableMakePayment()" ng-class="showMakePaymentButtonStatus()" ng-click="clickedMakePayment()"  id="make-payment" class="button modal-close" >
							Make Payment
						</button>
					</span>
						<span ng-show="!shouldShowMakePaymentButton"><button type="button" ng-disabled="disableMakePayment()" ng-class="showRefundButtonStatus()" ng-click="clickedMakePayment()"  id="make-payment" class="button modal-close" >
							Refund {{currencySymbol}}{{refundAmount}}
						</button></span> -->
					</span>

				</div>

				<div class="actions" ng-show="depositWithGiftCard" ng-hide="!depositWithGiftCard">
					<button type="button" id="close" class="button blank modal-close" ng-click="closeDepositModal()">
						Close
					</button>
					<span ng-hide="depositPaidSuccesFully">
							<span>
								<button type="button" ng-disabled="disableMakePayment()" ng-class="showMakePaymentButtonStatus()" ng-click="clickedMakePayment()"  id="make-payment"  class="button modal-close"
								ng-hide="hideMakePayment()" >
								Make Payment
								</button>
							</span>

					 <!-- the below functionality will be implemented later CICO-13435 -->
						<!-- <span ng-show="shouldShowMakePaymentButton"><button type="button" ng-disabled="disableMakePayment()" ng-class="showMakePaymentButtonStatus()" ng-click="clickedMakePayment()"  id="make-payment" class="button modal-close" >
							Make Payment
						</button>
					</span>
						<span ng-show="!shouldShowMakePaymentButton"><button type="button" ng-disabled="disableMakePayment()" ng-class="showRefundButtonStatus()" ng-click="clickedMakePayment()"  id="make-payment" class="button modal-close" >
							Refund {{currencySymbol}}{{refundAmount}}
						</button></span> -->
					</span>

				</div>
                </div>
			</div>
		</fieldset>
	</form>
	<div ng-if="shouldShowWaiting && pageloadingOver">
		<div class="modal-content modal-vertical-centered" style="position: relative;padding: 40px;text-align: center;">
				<div class="centeralign alert-box">
					WAITING FOR PAYMENT COMPLETION
				</div>
				<div class="waiting-payment">&nbsp;</div>
		</div>
	</div>

</div>
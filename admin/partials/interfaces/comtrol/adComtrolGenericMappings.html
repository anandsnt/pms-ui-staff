<div class="form float" ng-if="state.activeTab === 'GENERIC'">
    <div class="entry full-width" ng-controller="adComtrolGenericMappingCtrl">
        <div ng-include="'/assets/partials/common/notification_message.html'"></div>
        <div ng-include="'/assets/partials/common/notification_success_message.html'"></div>

        <div class="form-title full-width">
            <h3>Generic Mapping</h3>
        </div>

        <div class="entry full-width" ng-show="state.mode !== 'ADD'">
            <div class="content-title" style="position: relative;">
                <span class="count">MAPPINGS({{mappings.length - state.deletedCount}})</span>
                <button ng-click="onClickAdd()" class="action add" scrollup="replacing-div-first">Add new</button>
            </div>
        </div>

        <div id="add-new" ng-show="state.mode === 'ADD'">
            <div class="data-holder">
                <form class="form inline-form float">
                    <div class="form-title">
                        <h3><span></span> {{'ADD_GENERIC_MAPPING'| translate}} </h3>
                        <em class="status"> {{'MANDATORY_FIELDS_MESSAGE1' | translate}} <strong>*</strong>
                            {{'MANDATORY_FIELDS_MESSAGE2' | translate}} </em>
                    </div>

                    <fieldset class="holder left float">
                        <ad-dropdown-name label-in-drop-down="{{'EXTERNAL_TYPE_PLACEHOLDER' | translate}}"
                                          savemodel="state.new.external_type"
                                          valueproperty="code"
                                          label-properties="['value']"
                                          required="yes"
                                          list="state.extTypes"
                                          label="{{'EXTERNAL_TYPE' | translate}}"
                                          class="full-width"
                                          change-handler="onChangeExternalType">
                        </ad-dropdown-name>
                        <ad-dropdown-name label-in-drop-down="{{'SELECT_CHARGE_CODE_PLACEHOLDER' | translate}}"
                                          savemodel="state.new.charge_code_name"
                                          valueproperty="name"
                                          label-properties="['name','description']"
                                          prefix-value="true"
                                          required="yes"
                                          list="state.chargeCodes"
                                          label="{{'CHARGE_CODE' | translate}}"
                                          class="full-width">
                        </ad-dropdown-name>
                    </fieldset>
                    <fieldset class="holder right float" ng-if="state.new.external_type !== 'tip_charge_code'">
                        <ad-textbox ng-if="state.new.external_type !== 'call_accounting'"
                                    styleclass="full-width" value="state.new.external_code"
                                    label="{{'EXTERNAL_CODE' | translate}}"
                                    required="yes"
                                    placeholder="{{'EXTERNAL_CODE_PLACEHOLDER' | translate}}"></ad-textbox>
                        <ad-dropdown-name ng-if="state.new.external_type === 'call_accounting'"
                                          label-in-drop-down="{{'EXTERNAL_CODE_PLACEHOLDER' | translate}}"
                                          savemodel="state.new.external_code"
                                          valueproperty="code"
                                          label-properties="['code','value']"
                                          required="yes"
                                          list="state.extCodes"
                                          label="{{'EXTERNAL_CODE' | translate}}"
                                          class="full-width">
                        </ad-dropdown-name>
                        <ad-toggle-button is-checked="state.new.is_default"
                                          label="{{'DEFAULT'| translate}}">
                        </ad-toggle-button>
                    </fieldset>

                    <div class="actions float">
                        <button type="button" ng-click="onCancelAdd()" class="button blank edit-data-inline"
                                translate>
                            CANCEL
                        </button>
                        <button type="button" ng-click="onSave()" class="button green edit-data-inline"
                                ng-class="{'grey' : state.new.charge_code_name == '' || state.new.external_type == '' || state.new.external_code == ''}"
                                ng-disabled="state.new.charge_code_name == '' || state.new.external_type == '' || state.new.external_code == ''"
                                translate>
                            SAVE_CHANGES
                        </button>
                    </div>
                </form>
            </div>
        </div>
        <table id="brands" class="grid datatable dataTable"
               ng-show="mappings.length - state.deletedCount > 0"
               ng-table="itemList" template-pagination="nil">
            <tbody>
            <tr ng-repeat="mapping in mappings track by $index" ng-hide="mapping.isDeleted">
                <td data-item="1" data-title="'External Code'" ng-click="onSelect($index, mapping)"
                    header-class="width-20" ng-hide="state.selected === $index">
                    <a class="edit-data-inline">{{mapping.external_code}}</a>
                </td>
                <td data-item="2" data-title="'External Value'" ng-click="onSelect($index, mapping)"
                    header-class="width-30" ng-hide="state.selected === $index">
                    <a class="edit-data-inline">{{getExternalType(mapping.external_type) || mapping.external_type}}</a>
                </td>

                <td data-item="3" data-title="'Charge Code'" ng-click="onSelect($index, mapping)"
                    header-class="width-30" ng-hide="state.selected === $index">
                    <a class="edit-data-inline">
                        {{mapping.charge_code_name}}
                        <em>{{getChargeCodeDescription(mapping.charge_code_name)}}</em>
                    </a>
                </td>

                <td data-item="4" data-title="'Default'"
                    header-class="width-10" ng-hide="state.selected === $index">
                    <div class="entry">
                        <div class="switch-button single" ng-class="{ on: mapping.is_default }">
                            <input type="checkbox" id="rates-addons" name="rates-addons" ng-click="onToggleDefault(mapping)">
                            <span class="switch-icon"></span>
                        </div>
                    </div>
                </td>

                <td header-class="width-10" data-title="'Delete'" class="delete"
                    ng-hide="state.selected === $index">
                    <a class="icons icon-delete large-icon" ng-click="onClickDelete(mapping)"></a>
                </td>

                <td colspan="5" ng-show="state.selected === $index">
                    <div style="display: block;" id="add-new" class="edit-data">
                        <div class="data-holder">
                            <form class="form inline-form float">
                                <div class="form-title">
                                    <h3><span></span> {{'EDIT_GENERIC_MAPPING'| translate}} </h3>
                                    <em class="status"> {{'MANDATORY_FIELDS_MESSAGE1' | translate}} <strong>*</strong>
                                        {{'MANDATORY_FIELDS_MESSAGE2' | translate}} </em>
                                </div>

                                <fieldset class="holder left float">
                                    <ad-dropdown-name label-in-drop-down="{{'EXTERNAL_TYPE_PLACEHOLDER' | translate}}"
                                                      savemodel="mapping.external_type"
                                                      valueproperty="code"
                                                      label-properties="['value']"
                                                      required="yes"
                                                      list="state.extTypes"
                                                      label="{{'EXTERNAL_TYPE' | translate}}"
                                                      class="full-width"
                                                      change-handler="onChangeMappingExternalType"
                                                      change-handler-param="mapping">
                                    </ad-dropdown-name>
                                    <ad-dropdown-name label-in-drop-down="{{'SELECT_CHARGE_CODE_PLACEHOLDER' | translate}}"
                                                      savemodel="mapping.charge_code_name"
                                                      valueproperty="name"
                                                      label-properties="['name','description']"
                                                      prefix-value="true"
                                                      required="yes"
                                                      list="state.chargeCodes"
                                                      label="{{'CHARGE_CODE' | translate}}"
                                                      class="full-width">
                                    </ad-dropdown-name>
                                </fieldset>
                                <fieldset class="holder right float">
                                    <ad-textbox ng-if="mapping.external_type !== 'tip_charge_code' && mapping.external_type !== 'call_accounting'"
                                                styleclass="full-width" value="mapping.external_code"
                                                label="{{'EXTERNAL_CODE' | translate}}"
                                                required="yes"
                                                placeholder="{{'EXTERNAL_CODE_PLACEHOLDER' | translate}}"></ad-textbox>
                                    <ad-dropdown-name ng-if="mapping.external_type !== 'tip_charge_code' && mapping.external_type === 'call_accounting'"
                                                      label-in-drop-down="{{'EXTERNAL_CODE_PLACEHOLDER' | translate}}"
                                                      savemodel="mapping.external_code"
                                                      valueproperty="code"
                                                      label-properties="['code','value']"
                                                      required="yes"
                                                      list="state.extCodes"
                                                      label="{{'EXTERNAL_CODE' | translate}}"
                                                      class="full-width">
                                    </ad-dropdown-name>
                                    <ad-toggle-button is-checked="mapping.is_default"
                                                      label="{{'DEFAULT'| translate}}">
                                    </ad-toggle-button>
                                </fieldset>

                                <div class="actions float">
                                    <button type="button" ng-click="onCancelEdit()" class="button blank edit-data-inline"
                                            translate>
                                        CANCEL
                                    </button>
                                    <button type="button" ng-click="onUpdate(mapping)" class="button green edit-data-inline"
                                            ng-class="{'grey' : mapping.charge_code_name == '' || mapping.external_type == '' || mapping.external_code == ''}"
                                            ng-disabled="mapping.charge_code_name == '' || mapping.external_type == '' || mapping.external_code == ''"
                                            translate>
                                        SAVE_CHANGES
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

